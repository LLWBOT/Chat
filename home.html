<!DOCTYPE html>
<html>
<head>
  <title>Home</title>
  <style>
    body { font-family: sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
    #container { background-color: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); width: 100%; max-width: 400px; text-align: center; }
    #profile-pic { width: 100px; height: 100px; border-radius: 50%; object-fit: cover; margin-bottom: 15px; }
    h2 { color: #333; margin: 0; }
    p { color: #666; font-size: 0.9em; }
    .btn { display: block; width: 100%; padding: 10px; margin-top: 15px; background-color: #007bff; color: white; text-decoration: none; border-radius: 4px; }
    .btn:hover { background-color: #0056b3; }
  </style>
</head>
<body>
  <div id="container">
    <img id="profile-pic" src="default-profile.png" alt="Profile Picture">
    <h2 id="user-name">Loading...</h2>
    <p>Your ID: <span id="user-id">Loading...</span></p>
    <a href="chat.html" class="btn">Chat</a>
    <button id="logout-btn" class="btn" style="background-color: #dc3545;">Log Out</button>
  </div>

  <script>
    const token = localStorage.getItem('token');
    if (!token) {
      window.location.href = 'index.html';
    }

    async function loadUserProfile() {
      try {
        const response = await fetch('https://sleepy-freddi-primellw-06a0752a.koyeb.app/api/profile', {
          headers: { 'Authorization': `Bearer ${token}` }
        });
        const data = await response.json();
        if (response.ok) {
          document.getElementById('profile-pic').src = data.profilePicture || 'default-profile.png';
          document.getElementById('user-name').textContent = data.username;
          document.getElementById('user-id').textContent = data.uniqueId;
        } else {
          alert(data.message);
          window.location.href = 'index.html';
        }
      } catch (error) {
        console.error('Error:', error);
        window.location.href = 'index.html';
      }
    }
    loadUserProfile();
    
    // Add the log out functionality
    document.getElementById('logout-btn').addEventListener('click', () => {
      localStorage.removeItem('token');
      window.location.href = 'index.html';
    });
  </script>
</body>
</html>
